# Docker

docker-logs() {
    docker logs -f --tail=200 $@
}

docker-it() {
    docker exec -it -e COLUMNS="`tput cols`" $@
}

# Misc only on ubuntu desktop
#open() {
#    gio open $@
#}

openssl_describe() {
    openssl x509 -in $1 -text
}

tmpfile() {
  N=/tmp/tmpfile-$(openssl rand -hex 4)
  touch $N
  echo $N
}

tmpdir() {
  N=/tmp/tmpdir-$(openssl rand -hex 4)
  mkdir $N
  echo $N
}

gc() {
  msg="$@"
  if [ -z "$msg" ]; then
    git commit -v
  else
    git commit -m "$msg"
  fi
}

# Tmux requires tmux
lasturls() { # TODO move to dotfiles scripts
  tmux capture-pane -p | grep -Eo 'https?://[^ >]+'
}
lasturl() { # TODO move to dotfiles scripts
  lasturls | perl -e 'print reverse <>' | head -n 1
}
openlast() {
  url=$(lasturl)
  if [ -z "${url}" ]; then
    echo "no url found"
  else
    open $url
  fi
}

cd-git-root() {
  if ! git rev-parse --is-inside-work-tree > /dev/null 2>&1; then
    echo "Error: Not in a git repository" >&2
    return 1
  fi

  local git_root
  git_root=$(git rev-parse --show-toplevel)

  if [ -z "$git_root" ]; then
    echo "Error: Could not determine git repository root" >&2
    return 1
  fi

  cd "$git_root" || { echo "Error: Could not change to $git_root" >&2; return 1; }

  echo "cd into: $(pwd)"
  return 0
}

